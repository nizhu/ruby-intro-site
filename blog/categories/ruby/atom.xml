<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby | Ruby Intro]]></title>
  <link href="http://nizhu.github.io/ruby-intro-site/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://nizhu.github.io/ruby-intro-site/"/>
  <updated>2013-08-06T20:45:39+10:00</updated>
  <id>http://nizhu.github.io/ruby-intro-site/</id>
  <author>
    <name><![CDATA[Nick Zhu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Deploying with Heroku]]></title>
    <link href="http://nizhu.github.io/ruby-intro-site/blog/2013/08/05/deploying-with-heroku/"/>
    <updated>2013-08-05T22:55:00+10:00</updated>
    <id>http://nizhu.github.io/ruby-intro-site/blog/2013/08/05/deploying-with-heroku</id>
    <content type="html"><![CDATA[<p>Heroku is a pioneer in what we now call Platform-As-A-Service. It&rsquo;s a little on the expensive side to scale on it, but its great for developing with as there is a freebie tier and its service makes deploying to the internet a breeze. Be aware however that if you need a database, PostgreSQL is your only option.</p>

<p>The newcomer in town is <a href="https://www.appfog.com/pricing/">Appfog</a>. They&rsquo;re a lot cheaper than Heroku and supports MySQL in addition to PostgreSQL, but I haven&rsquo;t had the chance to check them out yet.</p>

<h2>Step 1</h2>

<p><a href="https://id.heroku.com/signup">Sign up to Heroku</a></p>

<h2>Step 2</h2>

<p><a href="https://toolbelt.heroku.com">Install the Heroku Toolbelt</a></p>

<h2>Step 3</h2>

<p>In the root folder of your application, type in the following commands</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Initialize a git repository&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git init&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Login to heroku <span class="o">(</span>enter your username and password as prompted, generate ssh key <span class="k">if </span>required<span class="o">)</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku login&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Create a new app on heroku&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Make note of the output of this <span class="nb">command</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;The http url is where your application will be available &amp;ndash; &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://&quot;</span>&gt;http://&lt;/a&gt;&lt;app name&gt;.heroku.com&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;The git url is where you will be deploying the application to &amp;ndash; git://heroku.com:&lt;app name&gt;.git&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;The last line should say &amp;lsquo;Git remote heroku added&amp;rsquo;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;If it doesn&amp;rsquo;t, <span class="k">do</span> &amp;lsquo;heroku git:remote -a &lt;app name&gt;&amp;rsquo;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku create&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Add everything to git staging&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git add .&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Commit the repository&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git commit -m &amp;ldquo;initial commit&amp;rdquo;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Push to Heroku <span class="k">for </span>the first <span class="nb">time</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git push heroku master&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Ensure that only 1 web dyno will be running&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku ps:scale <span class="nv">web</span><span class="o">=</span>1
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Step 4</h2>

<p>Your app should now be available in the http url mentioned in step 3. If there are any problems, you can watch your application&rsquo;s live logging by using <code>heroku logs -t</code>. As usual, google your issues :) There are some relevant links to documentation below too.</p>

<ol>
<li><a href="https://id.heroku.com/signup">Heroku Signup</a></li>
<li><a href="https://toolbelt.heroku.com">Heroku Toolbelt</a></li>
<li><a href="https://devcenter.heroku.com/articles/quickstart">Heroku Quickstart</a></li>
<li><a href="https://devcenter.heroku.com/articles/rails4">Heroku Rails4</a></li>
<li><a href="https://devcenter.heroku.com/articles/rails3">Heroku Rails3</a></li>
<li><a href="https://devcenter.heroku.com/articles/usage-and-billing#750-free-dyno-hours-per-app">Heroku Billing</a></li>
<li><a href="https://www.appfog.com/pricing/">Appfog Pricing</a></li>
<li><a href="http://seng2021-rails-demo.herokuapp.com/">Demo on Heroku</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Prettifying with Bootstrap]]></title>
    <link href="http://nizhu.github.io/ruby-intro-site/blog/2013/08/05/prettifying-with-bootstrap/"/>
    <updated>2013-08-05T22:27:00+10:00</updated>
    <id>http://nizhu.github.io/ruby-intro-site/blog/2013/08/05/prettifying-with-bootstrap</id>
    <content type="html"><![CDATA[<p>Since Twitter open sourced their CSS framework several years ago, Bootstrap has become the benchmark for CSS. As a terrible designer, I&rsquo;ve very much relied on Bootstrap to make my web pages decent looking, not great &ndash; just OK.</p>

<p>I&rsquo;ve opted for a slightly older version (2.3.2) here since the new version 3 is not yet stable at the time of writing. The documentation for 2.3.2 can be found <a href="http://getbootstrap.com/2.3.2/">here</a>. Regardless, there&rsquo;s only 3 files to change.</p>

<p>&lt;% codeblock lang:html app/views/layouts/application.html.erb %>
&lt;!DOCTYPE html>
<html>
<head>
  <title>TwitterApp</title>
  <link href="http://nizhu.github.io/ruby-intro-site//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
  &lt;%= stylesheet_link_tag    &ldquo;application&rdquo;, media: &ldquo;all&rdquo;, &ldquo;data-turbolinks-track&rdquo; => true %>
  &lt;%= javascript_include_tag &ldquo;application&rdquo;, &ldquo;data-turbolinks-track&rdquo; => true %>
  &lt;%= csrf_meta_tags %>
</head>
<body>
  <div class="container"></p>

<pre><code>&lt;div class="navbar"&gt;
  &lt;div class="navbar-inner"&gt;
    &lt;a class="brand" href="http://nizhu.github.io/ruby-intro-site/"&gt;Twitter App&lt;/a&gt;
    &lt;ul class="nav"&gt;
      &lt;li&gt;&lt;a href="http://nizhu.github.io/ruby-intro-site/proposals"&gt;JB Proposals&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="http://nizhu.github.io/ruby-intro-site/ausvotes"&gt;#ausvotes&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>&lt;%= yield %>
  </div>
</body>
</html>
&lt;% endcodeblock %></p>

<p>And add <code>class="table"</code> to the 2 table tags</p>

<p>&lt;% codeblock lang:html app/views/twitter/ausvotes.html.erb %></p>

<h1>Last 200 Tweets with #ausvotes</h1>




<table class="table">
  <tr>
    <th>User</th>
    <th>Text</th>
  </tr>
<% @tweets.each do |tweet| %>
  <tr>
    <td><%= tweet.user.name %></td>
    <td><%= tweet.text %></td>
  </tr>
<% end %>
</table>


<p>&lt;% endcodeblock</p>

<p>&lt;% codeblock lang:html app/views/twitter/proposals.html.erb %></p>

<h1>Last 200 Justin Bieber Proposals</h1>




<table class="table">
  <tr>
    <th>User</th>
    <th>Text</th>
  </tr>
<% @tweets.each do |tweet| %>
  <tr>
    <td><%= tweet.user.name %></td>
    <td><%= tweet.text %></td>
  </tr>
<% end %>
</table>


<p>&lt;% endcodeblock %></p>

<ol>
<li><a href="http://getbootstrap.com/2.3.2/">Twitter Bootstrap</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby on Rails]]></title>
    <link href="http://nizhu.github.io/ruby-intro-site/blog/2013/08/04/ruby-on-rails/"/>
    <updated>2013-08-04T19:58:00+10:00</updated>
    <id>http://nizhu.github.io/ruby-intro-site/blog/2013/08/04/ruby-on-rails</id>
    <content type="html"><![CDATA[<p>As I mentioned in the very first post, Rails has been credited with Ruby&rsquo;s sudden, meteoric rise in popularity. It&rsquo;s not the only web application framework for Ruby, but it remains by far the most popular to this day. If you&rsquo;re interested in a career in web development and want to stay away from corporate enterprises, this is a great way to go about it.</p>

<p>Rails emphasises the Model-View-Controller principle, and if you&rsquo;re not familiar with the concept, it&rsquo;s essentially the separation of the data, to the logic of processing the data, and the display of the processing results (links at the bottom for more details). The application I&rsquo;ll be demoing will ignore the Model part however. This is a very simple application will retrieve some data from Twitter, same as the previous post, and display it on a webpage.</p>

<p>As always, start by installing it&hellip;<code>gem install rails</code></p>

<h2>Scaffolding</h2>

<p>One of the big features of rails is scaffolding &ndash; automatically generating common parts of an application. This is the first step of development. Here, we&rsquo;re asking rails to scaffold the project without support for a database.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd ~
</span><span class='line'>rails new twitter_app -O
</span><span class='line'>cd twitter_app
</span><span class='line'>rails generate controller twitter</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The rails generator has created a lot of new files &ndash; about 80 in fact &ndash; but there aren&rsquo;t that many we need to worry about.</p>

<p>Before you begin editing the files, copy the twitter configuration file from the previous pages to the <code>config/initializers</code> directory. Files in this directory are run when the server is started.</p>

<h2>The Rails Router</h2>

<p>It&rsquo;s advisable that you leave the commented out lines here until you get the hand of routing just for your reference.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/routes.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">TwitterApp</span><span class="p">:</span><span class="ss">:Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">root</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">twitter</span><span class="c1">#proposals&amp;rsquo;</span>
</span><span class='line'>  <span class="n">get</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">proposals</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">twitter</span><span class="c1">#proposals&amp;rsquo;</span>
</span><span class='line'>  <span class="n">get</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">ausvotes</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">twitter</span><span class="c1">#ausvotes&amp;rsquo;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The first line in the block points the root path, <code>/</code> to the proposals function in the twitter controller. The second and third points <code>/proposals`` and</code>/ausvotes``` paths to their respective functions in the same controller.</p>

<h2>The Twitter controller</h2>

<p>The code here is almost identical to that from the previous Twitter post. Now, we&rsquo;re just keeping all the tweets in an array instead of just printing it. At the end of the processing, Rails will first render <code>views/layouts/application.html.erb</code>. Unless you specify which HTML template to use with the <code>render</code> function, rails will automatically look for the template <code>views/&lt;controller name&gt;/&lt;function name&gt;.*</code>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/controllers/twitter_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">twitter</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span><span class='line'><span class="k">class</span> <span class="nc">TwitterController</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ApplicationController</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def proposals&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="vi">@tweets</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
</span><span class='line'><span class="n">max_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="n">t</span> <span class="o">=</span> <span class="no">Twitter</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;to:justinbieber marry me&quot;</span><span class="p">,</span> <span class="ss">:count</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">100</span><span class="p">,</span> <span class="ss">:result_type</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="s2">&quot;recent&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">t</span><span class="o">.</span><span class="n">statuses</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">tweet</span> <span class="o">|</span>
</span><span class='line'>    <span class="vi">@tweets</span><span class="o">.</span><span class="n">push</span> <span class="n">tweet</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">max_id</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">next_results</span><span class="o">[</span><span class="ss">:max_id</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def ausvotes&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="vi">@tweets</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
</span><span class='line'><span class="n">max_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="n">t</span> <span class="o">=</span> <span class="no">Twitter</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;#ausvotes -rt&quot;</span><span class="p">,</span> <span class="ss">:count</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">100</span><span class="p">,</span> <span class="ss">:result_type</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="s2">&quot;recent&quot;</span><span class="p">,</span> <span class="ss">:max_id</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">max_id</span><span class="p">)</span>
</span><span class='line'>  <span class="n">t</span><span class="o">.</span><span class="n">statuses</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">tweet</span> <span class="o">|</span>
</span><span class='line'>    <span class="vi">@tweets</span><span class="o">.</span><span class="n">push</span> <span class="n">tweet</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">max_id</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">next_results</span><span class="o">[</span><span class="ss">:max_id</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Justin Bieber Proposals page</h2>

<p>If you&rsquo;re familiar with JSP or PHP, this is very much the same &ndash; HTML mixed in with some code. Here, we&rsquo;re making a simple table but we&rsquo;re creating a row for each tweet.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/twitter/proposals.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Last 200 Justin Bieber Proposals<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>User<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>Text<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="err">&lt;</span>% @tweets.each do |tweet| %&gt;
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= tweet.user.name %&gt;<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= tweet.text %&gt;<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="err">&lt;</span>% end %&gt;
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>#ausvotes page</h2>

<p>Identical to the above. Do try to refactor this :)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/twitter/ausvotes.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Last 200 Tweets with #ausvotes<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;table&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>User<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>    <span class="nt">&lt;th&gt;</span>Text<span class="nt">&lt;/th&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="err">&lt;</span>% @tweets.each do |tweet| %&gt;
</span><span class='line'>  <span class="nt">&lt;tr&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= tweet.user.name %&gt;<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>    <span class="nt">&lt;td&gt;</span><span class="err">&lt;</span>%= tweet.text %&gt;<span class="nt">&lt;/td&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/tr&gt;</span>
</span><span class='line'><span class="err">&lt;</span>% end %&gt;
</span><span class='line'><span class="nt">&lt;/table&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Deploying with WEBrick</h2>

<p>WEBrick is a very simple Rails web server, perfect for dev testing. Just go to the root directory of the application and type in <code>rails server</code>. WEBrick listens to port 3000 by default, but look carefully at its output if you come across any problems. The JB Proposals page will be available in @ <code>http://0.0.0.0:3000</code> and <code>http://0.0.0.0:3000/proposals</code> while the #ausvotes page will be available at <code>http://0.0.0.0:3000/ausvotes</code>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rails server
</span><span class='line'>=> Booting WEBrick
</span><span class='line'>=> Rails 4.0.0 application starting in development on &lt;a href="http://0.0.0.0:3000">http://0.0.0.0:3000&lt;/a>
</span><span class='line'>=> Run &lt;code>rails server -h&lt;/code> for more startup options
</span><span class='line'>=> Ctrl-C to shutdown server
</span><span class='line'>[2013-08-05 22:13:15] INFO  WEBrick 1.3.1
</span><span class='line'>[2013-08-05 22:13:15] INFO  ruby 2.0.0 (2013-06-27) [x86_64-darwin12.4.0]
</span><span class='line'>[2013-08-05 22:13:15] INFO  WEBrick::HTTPServer#start: pid=25428 port=3000</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Adding links between the 2 pages</h2>

<p>We want the user to be able to easily manuever between the 2 pages so let&rsquo;s put hyperlinks to the 2 pages at the top of every page (just add the 2 anchor bits in the html below).</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/layouts/application.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="ni">&amp;lt;</span>!DOCTYPE html&gt;
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>  <span class="nt">&lt;title&gt;</span>TwitterApp<span class="nt">&lt;/title&gt;</span>
</span><span class='line'>  <span class="ni">&amp;lt;</span>%= stylesheet_link_tag    <span class="ni">&amp;ldquo;</span>application<span class="ni">&amp;rdquo;</span>, media: <span class="ni">&amp;ldquo;</span>all<span class="ni">&amp;rdquo;</span>, <span class="ni">&amp;ldquo;</span>data-turbolinks-track<span class="ni">&amp;rdquo;</span> =&gt; true %&gt;
</span><span class='line'>  <span class="ni">&amp;lt;</span>%= javascript_include_tag <span class="ni">&amp;ldquo;</span>application<span class="ni">&amp;rdquo;</span>, <span class="ni">&amp;ldquo;</span>data-turbolinks-track<span class="ni">&amp;rdquo;</span> =&gt; true %&gt;
</span><span class='line'>  <span class="ni">&amp;lt;</span>%= csrf_meta_tags %&gt;
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://nizhu.github.io/ruby-intro-site/proposals&quot;</span><span class="nt">&gt;</span>JB Proposals<span class="nt">&lt;/a&gt;</span>
</span><span class='line'>  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://nizhu.github.io/ruby-intro-site/ausvotes&quot;</span><span class="nt">&gt;</span>#ausvotes<span class="nt">&lt;/a&gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>%= yield %&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;/body&gt;</span>
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Just refresh the page to take affect. Notice that this change did not require you to restart WEBrick. Some changes, eg. config changes, will require you to do so.</p>

<ol>
<li><a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">Wikipedia on MVC</a></li>
<li><a href="http://www.codinghorror.com/blog/2008/05/understanding-model-view-controller.html">Jeff Atwood on MVC</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Accessing Twitter's API]]></title>
    <link href="http://nizhu.github.io/ruby-intro-site/blog/2013/08/01/accessing-the-twitter-api/"/>
    <updated>2013-08-01T19:25:00+10:00</updated>
    <id>http://nizhu.github.io/ruby-intro-site/blog/2013/08/01/accessing-the-twitter-api</id>
    <content type="html"><![CDATA[<p>Since mid June this year, the Twitter has forced users to use OAuth to authenticate and access its API. You can no longer access its data in a trivial way like the GitHub example before. You must get 4 keys from <a href="https://dev.twitter.com/apps">Twitter&rsquo;s developer page</a>: <code>Consumer key</code>, <code>Consumer secret</code>, <code>Access token</code> and <code>Access secret</code> &ndash; don&rsquo;t need to know what they mean yet, but the 2 secret keys should not be shared. OAuth is a real pain. These 4 keys won&rsquo;t give you access. They&rsquo;ll let you get 3 more one use keys which you can then use to access the API.</p>

<p>Fortunately for you as a Ruby user, there are two libraries that will do all the menial work for you. <a href="https://github.com/sferik/twitter">Twitter</a> is a conveniently named library to access the standard Twitter API (it is not developed by Twitter Inc) while the other is <a href="https://github.com/tweetstream/tweetstream">TweetStream</a> is designed to use Twitter&rsquo;s streaming API. It&rsquo;s unlikely that you&rsquo;ll need to use the streaming API for this assignment so I won&rsquo;t be showing you TweetStream.</p>

<h2>Twitter Gem</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git checkout twitter
</span><span class='line'>gem install twitter</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>I&rsquo;ve made a file out of the gem&rsquo;s authentication configuration code taken from its documentation. Just replace the strings with the your Twitter developer keys in twitter_config.rb. There are some usage examples <a href="https://github.com/sferik/twitter#usage-examples">here</a>, but there&rsquo;s plenty more functionality so do refer to the <a href="http://rdoc.info/gems/twitter">documentation</a>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>require &lsquo;twitter&rsquo;
</span><span class='line'>load &lsquo;twitter_config.rb&rsquo;</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Lets find the last person to have proposed to Justin Bieber</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>result = Twitter.search(&ldquo;to:justinbieber marry me&rdquo;, :count => 1, :result_type => &ldquo;recent&rdquo;)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>result.class&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Twitter::SearchResults&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>result.statuses[0].user.screen_name&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>4ever_beliebing&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Just to give another example, I&rsquo;m going to get the last tweet from each of users I&rsquo;m stalking.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>f = Twitter.friends
</span><span class='line'>f.class&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Twitter::Cursor&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>&mdash; &lt;a href="http://rdoc.info/gems/twitter/Twitter/Cursor">http://rdoc.info/gems/twitter/Twitter/Cursor&lt;/a>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>f.collection.class&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Array&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>f.collection[0].class&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Twitter::User&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>&mdash; &lt;a href="http://rdoc.info/gems/twitter/Twitter/User">http://rdoc.info/gems/twitter/Twitter/User&lt;/a>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>f.collection[0].name&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>&ldquo;John Oliver&rdquo;&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>f.collection[0].status
</span><span class='line'>f.collection[0].status.class&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Twitter::Tweet&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>&mdash; &lt;a href="http://rdoc.info/gems/twitter/Twitter/Tweet">http://rdoc.info/gems/twitter/Twitter/Tweet&lt;/a>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>f.collection[0].status.text&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>&ldquo;Mugabe is the Harlem Globetrotters of democracy. His winning record is undeniably impressive, but he doesn&rsquo;t really play by the rules.&rdquo;&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>for user in f.collection.each
</span><span class='line'>  puts &ldquo;#{user.name} said &lsquo;#{user.status.text}&rsquo;&rdquo;
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Because we don&rsquo;t care about the return value, let&rsquo;s not do this in <code>irb</code></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>last_twitter_status.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;!/us</span><span class="n">r</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">ruby</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;require &amp;lsquo;twitter&amp;rsquo;</span>
</span><span class='line'><span class="sr">load &amp;lsquo;mine_twitter_config.rb&amp;rsquo;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">f</span> <span class="o">=</span> <span class="no">Twitter</span><span class="o">.</span><span class="n">friends</span>
</span><span class='line'><span class="k">for</span> <span class="n">user</span> <span class="k">in</span> <span class="n">f</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">each</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="c1">#{user.name} said &amp;lsquo;#{user.status.text}&amp;rsquo;&amp;rdquo;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>But there&rsquo;s still a problem, I&rsquo;m following more users than this.</p>

<p>This is because Twitter paginates the results to 20 by default.  So if there is more than 20 records, you&rsquo;ll have to iterate through each page to get all the results.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>lots_twitter_status.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;!/us</span><span class="n">r</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">ruby</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;require &amp;lsquo;twitter&amp;rsquo;</span>
</span><span class='line'><span class="sr">load &amp;lsquo;mine_twitter_config.rb&amp;rsquo;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">cursor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'><span class="k">while</span> <span class="n">cursor</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">f</span> <span class="o">=</span> <span class="no">Twitter</span><span class="o">.</span><span class="n">friends</span> <span class="ss">:cursor</span> <span class="o">=&gt;</span> <span class="n">cursor</span>
</span><span class='line'>  <span class="k">for</span> <span class="n">user</span> <span class="k">in</span> <span class="n">f</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">each</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;puts &quot;</span><span class="si">#{</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="sr"> said &#39;</span><span class="si">#{</span><span class="n">user</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="sr">&#39;&quot;</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end</span>
</span><span class='line'><span class="sr">  cursor = f.next_cursor</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Just to a more relevant example, this is to get the last 200 tweets with #ausvotes excluding retweets. Search results pagination work slightly different to friends &ndash; refer to documentation!!</p>

<p>Note that the count parameter refers to the number you want per page, although the maximum is 100.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>recent_ausvotes.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;!/us</span><span class="n">r</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">ruby</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;require &amp;lsquo;twitter&amp;rsquo;</span>
</span><span class='line'><span class="sr">load &amp;lsquo;mine_twitter_config.rb&amp;rsquo;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">max_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span class='line'><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>  <span class="n">t</span> <span class="o">=</span> <span class="no">Twitter</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="c1">#ausvotes -rt&amp;rdquo;, :count =&gt; 100, :result_type =&gt; &amp;ldquo;recent&amp;rdquo;, :max_id =&gt; max_id)</span>
</span><span class='line'>  <span class="n">t</span><span class="o">.</span><span class="n">statuses</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">tweet</span> <span class="o">|&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;puts &quot;</span><span class="si">#{</span><span class="n">tweet</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="sr"> said </span><span class="si">#{</span><span class="n">tweet</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="sr">&quot;</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end</span>
</span><span class='line'><span class="sr">  max_id = t.next_results[:max_id]</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ol>
<li><a href="https://github.com/sferik/twitter">RubyGem &ndash; Twitter</a></li>
<li><a href="https://github.com/tweetstream/tweetstream">RubyGem &ndash; Tweetstream</a></li>
<li><a href="https://dev.twitter.com/docs/auth">Twitter API Authentication Documentation</a></li>
<li><a href="https://dev.twitter.com/docs/api/1.1">Twitter API</a></li>
<li><a href="https://dev.twitter.com/apps">Twitter Developer Apps</a></li>
<li><a href="http://rdoc.info/gems/twitter">RDoc Twitter</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Consuming JSON REST resource through HTTP]]></title>
    <link href="http://nizhu.github.io/ruby-intro-site/blog/2013/07/31/consuming-json-rest-resource-through-http/"/>
    <updated>2013-07-31T21:44:00+10:00</updated>
    <id>http://nizhu.github.io/ruby-intro-site/blog/2013/07/31/consuming-json-rest-resource-through-http</id>
    <content type="html"><![CDATA[<p>As you saw in the previous post, XML is an overly verbose format so in the last few years, what we call JSON (JavaScript Object Notation) has come to dominate web communication. Ideally I&rsquo;d be demonstrating this with Twitter&rsquo;s API since you&rsquo;re likely to use it for this assignment, but since mid June this year, the Twitter API requires OAuth to access. I will be address this in the next post.</p>

<p>If you&rsquo;ve been writing Javascript, you love JSON. If you haven&rsquo;t, you soon will. Note that spaces, tabs and line breaks are all optional. I&rsquo;ve just added those to make it easier to read.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  &ldquo;id&rdquo;: 32,
</span><span class='line'>  &ldquo;name&rdquo;: &ldquo;Mother Duck&rdquo;,
</span><span class='line'>  &ldquo;children&rdquo;:[&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>{
</span><span class='line'>  "id": 12345,
</span><span class='line'>  "name": "Claire"
</span><span class='line'>},
</span><span class='line'>{
</span><span class='line'>  "id": 12372,
</span><span class='line'>  "name": "Daniel"
</span><span class='line'>}
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  ],
</span><span class='line'>  &ldquo;isAlive&rdquo;: true
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>That&rsquo;s all there is to JSON, very simple, very clear. <code>{}</code> encapsulates object/map/hash, while <code>[]</code> encapsulates an array, both of which can be nested infinitely. Otherwise only strings, numbers, booleans and null are supported values.</p>

<h2>Github API</h2>

<p>GitHub is an online source repository, extremely popular with open source projects. You won&rsquo;t be using any data from it for your projects, but it&rsquo;s the first public JSON API that came across my mind. I&rsquo;m sure you&rsquo;ll be using it somewhere in your career though. For this demonstration, I&rsquo;ll just be using the most simple of calls, retrieving the details of the GitHub user octocat. The documentation for GitHub&rsquo;s API is available <a href="http://developer.github.com/v3/">here</a>.</p>

<p>The easiest way to access this data, is to simply open a web browser and go to <code>https://api.github.com/users/octocat</code>. Next step further is accessing it through cURL.. <code>curl https://api.github.com/users/octocat</code>. Let&rsquo;s do it in Ruby.</p>

<h2>Retrieving with Net/HTTP and parsing with json</h2>

<p><a href="http://ruby-doc.org/stdlib-2.0/libdoc/net/http/rdoc/Net/HTTP.html">Net/HTTP</a> is a standard Ruby library, and it&rsquo;ll be your interface to the internet. JSON is a simple parser, but is not standard. As before, install the gem with <code>gem install json</code></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>require &lsquo;net/http&rsquo;
</span><span class='line'>require &lsquo;json&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>uri = URI(&lsquo;&lt;a href="https://api.github.com/users/octocat">https://api.github.com/users/octocat&lt;/a>&rsquo;)
</span><span class='line'>response = Net::HTTP.get uri
</span><span class='line'>octocat = JSON.parse response&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>octocat.keys&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>[&ldquo;login&rdquo;, &ldquo;id&rdquo;, &ldquo;avatar_url&rdquo;, &ldquo;gravatar_id&rdquo;, &ldquo;url&rdquo;, &ldquo;html_url&rdquo;, &ldquo;followers_url&rdquo;, &ldquo;following_url&rdquo;, &ldquo;gists_url&rdquo;, &ldquo;starred_url&rdquo;, &ldquo;subscriptions_url&rdquo;, &ldquo;organizations_url&rdquo;, &ldquo;repos_url&rdquo;, &ldquo;events_url&rdquo;, &ldquo;received_events_url&rdquo;, &ldquo;type&rdquo;, &ldquo;name&rdquo;, &ldquo;company&rdquo;, &ldquo;blog&rdquo;, &ldquo;location&rdquo;, &ldquo;email&rdquo;, &ldquo;hireable&rdquo;, &ldquo;bio&rdquo;, &ldquo;public_repos&rdquo;, &ldquo;followers&rdquo;, &ldquo;following&rdquo;, &ldquo;created_at&rdquo;, &ldquo;updated_at&rdquo;, &ldquo;public_gists&rdquo;]&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>octocat[&ldquo;followers&rdquo;]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>398&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>octocat[&ldquo;public_repos&rdquo;]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>3&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>octocat[&ldquo;hireable&rdquo;]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>false&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>I had some issues here with openssl on the Mac, but the update instructions with Homebrew found <a href="http://railsapps.github.io/openssl-certificate-verify-failed.html">here</a> worked perfectly.</p>

<ol>
<li><a href="http://json.org/example.html">JSON Examples</a></li>
<li><a href="http://ruby-doc.org/stdlib-2.0/libdoc/net/http/rdoc/Net/HTTP.html">Ruby Net/HTTP</a></li>
<li><a href="http://flori.github.io/json/doc/index.html">Rubygem json</a></li>
</ol>

]]></content>
  </entry>
  
</feed>
